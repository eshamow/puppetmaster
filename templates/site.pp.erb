Package { allow_virtual => false }
resources { "firewall":
  purge => true
}

node '<%= @master %>' {
  Firewall {
    before  => Class['puppetmaster::firewall::post'],
    require => Class['puppetmaster::firewall::pre'],
  }
  class { 'puppetmaster':
    master => '<%= @master %>'
  }
  class { 'puppetdb': }
  class { 'puppetdb::master::config':
    puppet_service_name => 'httpd',
  }
  class { 'puppetmaster::firewall': }
  class { ['puppetmaster::firewall::pre', 'puppetmaster::firewall::post']: }
  class { 'firewall': }
}
